<!DOCTYPE html>
<link rel="icon" type="image/svg+xml" href="./favicon.svg" />
<link rel="icon" type="image/png" href="./favicon.png" />
<title>Simple Service Worker Test</title>
<script>
let SCOPE = './in-scope';
let WORKER_URL = 'sw.js';

function appendResult(message) {
  let result = document.getElementById('result');
  result.value += message + '\n';
}

addEventListener('load', () => {
    document.getElementById('register').addEventListener('click', () => {
        appendResult('registering');
        navigator.serviceWorker.register(WORKER_URL, {scope: SCOPE})
          .then(r => {
                console.log('registered!', r);
                appendResult('registered!');
            })
          .catch(() => {
              console.log('registration failed');
              appendResult('registration failed');
            });
      });
    document.getElementById('unregister').addEventListener('click', () => {
        navigator.serviceWorker.getRegistration(SCOPE)
          .then((r) => {
              if (r) {
                appendResult('unregistering...');
                return r.unregister();
              } else {
                appendResult('registration is not found.');
                return Promise.reject();
              }
            })
          .then(() => {
              console.log('unregistered!');
              appendResult('unregistered!');
            });
      });
    appendResult('loaded');
  });
</script>
<body>
  <div>
    <textarea id="result"></textarea>
  </div>
  <div>
    <button id="register">Register</button>
    <button id="unregister">Unregister</button>
  </div>
  <div id="link">
    <ul>
      <li><a href="./in-scope/">Go to "in-scope" page: "new Response('intercepted')</a></li>
      <li><a href="./in-scope/text">Go to "in-scope" page: "fetch('foo.txt')"</a></li>
    </ul>
  </div>
</body>

